load("//defs:package_defs.bzl", "download_source", "meson_package")
load("//defs:use_flags.bzl", "use_package", "set_use_flags", "use_dep")

# glib - GNOME core library (meson build)
# USE flags: doc, introspection, gtk-doc, systemtap, dtrace, test
# Default: none

download_source(
    name = "glib-src",
    src_uri = "https://download.gnome.org/sources/glib/2.80/glib-2.80.0.tar.xz",
    sha256 = "8228a92f92a412160b139ae68b6345bd28f24f5f4f4c4818a82b2a5ea0c6c90a",
)

meson_package(
    name = "glib",
    srcs = [":glib-src"],
    version = "2.80.0",
    src_uri = "https://download.gnome.org/sources/glib/2.80/glib-2.80.0.tar.xz",
    description = "Low-level core library for GNOME projects",
    homepage = "https://wiki.gnome.org/Projects/GLib",
    license = "LGPL-2.1+",
    meson_args = [
        "-Dman-pages=disabled",
        "-Ddtrace=false",
        "-Dsystemtap=false",
        "-Dgtk_doc=false",
        "-Dtests=false",
    ],
    deps = [
        "//packages/linux/system/libs/utility/libffi:libffi",
        "//packages/linux/core/zlib:zlib",
        "//packages/linux/system/libs/utility/pcre2:pcre2",
    ],
    visibility = ["PUBLIC"],
)
