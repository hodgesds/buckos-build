load("//defs:package_defs.bzl", "download_source", "binary_package")
load("//defs:use_flags.bzl", "use_package", "set_use_flags", "use_dep")

# USE flags: doc, test
# Default: none

download_source(
    name = "meson-src",
    src_uri = "https://github.com/mesonbuild/meson/releases/download/1.3.1/meson-1.3.1.tar.gz",
    sha256 = "d3eb539a556352f3f47881d71fb0e5777b2f3e9a4251d283c18c67ce996774b7",
)

binary_package(
    name = "meson",
    srcs = [":meson-src"],
    version = "1.3.1",
    description = "High productivity build system",
    homepage = "https://mesonbuild.com/",
    license = "Apache-2.0",
    install_script = """
        cd "$SRCS/meson-1.3.1" || cd "$SRCS"
        python3 setup.py build
        python3 setup.py install --root="$OUT" --prefix=/usr
    """,
    visibility = ["PUBLIC"],
)
